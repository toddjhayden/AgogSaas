# OWNER REQUESTS - Feature Backlog

This file tracks feature requests from product owners (Marcus, Sarah, Alex). The strategic orchestrator monitors this file and automatically spawns specialist workflows when new requests are detected.

## Request Format

```
REQ-{DOMAIN}-{NUMBER}: {Feature Title}
Status: {NEW | IN_PROGRESS | COMPLETE | BLOCKED | PENDING}
Owner: {marcus | sarah | alex}
Priority: {P0 | P1 | P2 | P3}
Business Value: {Brief description}

Status Meanings:
- NEW: Brand new request, will be picked up by orchestrator on next scan
- IN_PROGRESS: Workflow is actively running
- COMPLETE: Workflow finished successfully
- BLOCKED: Requires manual intervention
- PENDING: Recovery state only (crash/token limit), orchestrator verifies before starting
```

---

## Active Requests

### REQ-ITEM-MASTER-001: Item Master Pattern Implementation

**Status**: IN_PROGRESS
**Owner**: marcus
**Priority**: P0
**Business Value**: Enable unified item catalog supporting both materials (purchased) and products (sold/manufactured). Critical foundation for inventory, procurement, and sales modules.

**Requirements**:

- Unified items table with role flags (can_be_purchased, can_be_sold, can_be_manufactured)
- Support for dual-role items (e.g., blank labels that are both purchased and sold)
- Multi-UOM support with conversion factors
- 3-layer attribute model (material, product, physical)
- SCD Type 2 for price/attribute change history
- Integration with existing materials/products tables (migration strategy)

**Current Stage**: Critique (Sylvia evaluating Cynthia's research)

---

### REQ-STOCK-TRACKING-001: Real-Time Stock Level Monitoring

**Status**: IN_PROGRESS
**Owner**: marcus
**Priority**: P1
**Business Value**: Enable real-time visibility into inventory levels across all warehouses. Reduces stockouts by 60% and excess inventory by 40%.

**Requirements**:

- Real-time stock level tracking per item per warehouse
- Automated reorder point calculations
- Low stock alerts and notifications
- Stock movement history (receipts, issues, adjustments, transfers)
- Integration with Item Master (REQ-ITEM-MASTER-001)
- Dashboard showing current stock levels vs. min/max thresholds

---

### REQ-SALES-ORDER-ENTRY-001: Streamlined Sales Order Entry

**Status**: IN_PROGRESS
**Owner**: sarah
**Priority**: P0
**Business Value**: Reduce order entry time from 15 minutes to 2 minutes. Eliminate 70% of specification errors. Enable customer self-service.

**Requirements**:

- Quick order entry form with autocomplete
- Customer-specific pricing and discount application
- Product configurator for CTO (Configure-to-Order) items
- Real-time inventory availability check
- Delivery date estimation based on production schedule
- Order confirmation with PDF proof
- Integration with Item Master and Customer Master

---

### REQ-CUSTOMER-PRICING-001: Customer-Specific Pricing Engine

**Status**: IN_PROGRESS
**Owner**: sarah
**Priority**: P1
**Business Value**: Support volume discounts, customer-specific pricing, and promotional pricing. Increase average order value by 15%.

**Requirements**:

- Base price lists per item
- Customer-specific price overrides
- Volume discount tiers (quantity breaks)
- Promotional pricing with date ranges
- Contract pricing for enterprise customers
- Price history for audit trail (SCD Type 2)
- Pricing approval workflow for discounts > 20%

---

### REQ-VENDOR-MANAGEMENT-001: Vendor Master and Performance Tracking

**Status**: IN_PROGRESS
**Owner**: alex
**Priority**: P1
**Business Value**: Centralize vendor information and track performance. Reduce procurement costs by 10% through better vendor selection.

**Requirements**:

- Vendor master data (contact, payment terms, certifications)
- Vendor performance metrics (on-time delivery, quality ratings)
- Preferred vendor designation per item
- Vendor price lists and quote comparison
- Vendor certifications and compliance tracking
- Integration with Item Master (materials sourcing)

---

### REQ-PURCHASE-ORDER-001: Purchase Order Creation and Tracking

**Status**: IN_PROGRESS
**Owner**: alex
**Priority**: P0
**Business Value**: Automate PO creation based on reorder points. Enable three-way matching for invoice processing. Reduce manual PO processing time by 80%.

**Requirements**:

- PO creation from reorder point triggers
- PO approval workflow (based on amount thresholds)
- Receiving module with qty/quality checks
- Three-way matching (PO + Receipt + Invoice)
- PO status tracking (pending, approved, received, closed)
- Integration with Vendor Master and Stock Tracking
- Email PO delivery to vendors

---

### REQ-DEVOPS-ORCHESTRATOR-001: Debug and Fix Strategic Orchestrator Issues

**Status**: IN_PROGRESS
**Owner**: marcus
**Priority**: P0
**Business Value**: Ensure agent orchestration system is fully operational. Critical for autonomous AI-assisted development workflows. Without working orchestration, agents cannot process requests and the entire AI development platform is non-functional.

**CRITICAL ISSUES - Berry MUST FIX ALL:**

1. **Workflows never update to COMPLETE** - strategic-orchestrator.service.ts:486 subscribes to workflow.completed but NEVER calls updateRequestStatus(reqNumber, 'COMPLETE'). All workflows stuck at IN_PROGRESS forever.

2. **No git commits** - 161 uncommitted files, agents generate deliverables but never commit. No CI/CD runs, no security scans execute. Need workflow to commit on completion.

3. **NATS deliverable streams not auto-initialized** - Had to manually run init-nats-streams.ts. Should initialize on orchestrator startup.

4. **Workflow state lost on restart** - In-memory Map, restart loses all progress. Implement PostgreSQL persistence or NATS KV store.

5. **No recovery mechanism** - When deliverable publish fails, workflow stuck forever. Need retry/recovery logic.

6. **Race condition in duplicate prevention** - processedRequests.add() called 40 lines after check. Move before async operations.

7. **Missing subscription cleanup** - waitForDeliverable() doesn't drain subs on timeout. Memory leak.

8. **No environment validation** - Services start but fail silently with wrong config. Validate on startup.

9. **No health checks** - No /health endpoint, no Prometheus metrics for orchestrator daemon.

10. **No graceful shutdown** - Orchestrator doesn't drain NATS connections properly.

11. **No rate limiting** - Agent spawns not throttled, can overwhelm system.

12. **No security scans running** - GitHub Actions workflows exist but only trigger on push. Since nothing commits, nothing runs.

13. **No Claude API usage monitoring** - Orchestrator doesn't check Claude API usage before spawning agents. Can hit plan limits and cause failures. Need: (1) Check Claude API usage before each scan cycle (2) If usage >85%, calculate minutes until reset window (3) **ACTUAL SLEEP** - Use setTimeout or async sleep for exact minutes until reset (4) Resume orchestration after sleep completes. Example: If 85% used and 243 minutes until reset, sleep for 243 minutes then resume. Must respect user's plan limits.

**Already Fixed:**
- ✅ Volume mounts (changed /workspace to /app)  
- ✅ OWNER_REQUESTS path (changed to /app/project-spirit)
- ✅ Host listener NATS auth (added credentials)
- ✅ Regex patterns (allow blank lines)
- ✅ NATS deliverable streams manually initialized

**Expected Outcome:**

- Workflows complete end-to-end and update status to COMPLETE in OWNER_REQUESTS.md
- Agent deliverables committed to git automatically
- Security scans run on every commit
- Orchestrator survives restarts without losing workflow state
- **Usage monitoring active** - Orchestrator sleeps when Claude API >85%, resumes after reset
- All 13 critical issues fixed and tested
- Complete runbook for orchestration debugging
- Health monitoring operational

---

### REQ-INFRA-DASHBOARD-001: Fix Monitoring Dashboard Missing Dependencies

**Status**: IN_PROGRESS
**Owner**: marcus
**Priority**: P0
**Business Value**: Restore monitoring dashboard functionality. Critical for observing Layer 2 (Health Monitoring), Layer 3 (Orchestration), and Layer 4 (Memory) system health in real-time.

**Requirements**:

- Fix missing `react-i18next` dependency in frontend container
- Verify all other i18n dependencies are installed
- Ensure volume mounts don't override node_modules
- Test monitoring dashboard loads at http://localhost:3000/monitoring
- Verify all 4 monitoring cards render (System Health, Current Errors, Active Fixes, Agent Activity)
- **REQUIRED: Billy (QA) must use Playwright MCP to test actual user experience**
  - Navigate to http://localhost:3000/monitoring in real browser
  - Verify page loads without console errors
  - Verify all 4 cards are visible and contain data
  - Take screenshot of working dashboard
  - Test is NOT complete until Playwright confirms user can see the page
- Document fix in Miki's deliverables for future reference

**Technical Details**:

- Error: "Failed to resolve import 'react-i18next' from src/App.tsx"
- Location: Frontend container `/app/node_modules`
- Likely cause: Volume mount or missing package installation
- Expected fix: Ensure `npm install` runs with all dependencies, check docker-compose volumes

**Owner-Provided Assets**:

- See `project-spirit/owner_requests/assets/REQ-INFRA-DASHBOARD-001/` for screenshots of the issue

---


### REQ-PROACTIVE-001: Enable Autonomous Work Generation System

**Status**: IN_PROGRESS
**Owner**: marcus
**Priority**: P0
**Business Value**: Transform from reactive (waiting for manual OWNER_REQUESTS.md edits) to proactive (AI agents autonomously identify and create feature requests). Enable continuous improvement without constant human input. Maximize value delivery by surfacing high-impact opportunities automatically.

**Requirements**:

- Integrate **value-chain-expert** agent into daemon mode
  - Periodic strategic evaluation (daily scan)
  - Analyze business metrics, competitive landscape, technical debt
  - Generate RICE-scored feature recommendations
  - Publish recommendations to OWNER_REQUESTS.md via NATS

- Integrate **project-manager** agent into orchestration
  - Create and maintain roadmap.md as single source of truth
  - Break strategic initiatives into atomic phases
  - Identify dependencies and sequencing
  - Auto-generate phased feature requests

- Enable **product owner agents** (Marcus/Sarah/Alex) to run proactively
  - Periodic domain-specific opportunity scanning
  - Monitor domain metrics (inventory levels, sales patterns, procurement efficiency)
  - Auto-create feature requests when thresholds met
  - Example: Marcus detects stockout patterns → creates REQ-STOCK-xxx automatically

- Create **backlog management workflow**
  - value-chain-expert evaluates proposed features (RICE scoring)
  - project-manager breaks into phases and adds to roadmap
  - Strategic orchestrator detects roadmap.md changes
  - Auto-create phased requests in OWNER_REQUESTS.md

- Implement **feedback loop**
  - Priya's statistics feed back into value-chain-expert
  - Completed features update business metrics
  - Metrics inform next proactive recommendations

- Add **governance controls**
  - Human approval gate for auto-generated P0/P1 requests
  - Auto-approve P2/P3 technical debt cleanup
  - Configurable thresholds for autonomous work creation

**Expected Outcome**:

- System generates 3-5 high-quality feature requests per week autonomously
- roadmap.md maintained and up-to-date automatically
- Product owners (Marcus/Sarah/Alex) focus on review/approval instead of ideation
- Strategic evaluation happens continuously, not ad-hoc
- OWNER_REQUESTS.md becomes living document, not stale backlog

---

## Completed Requests

_None yet - first workflows in progress_

---

## Blocked Requests

_None yet_

---

## Request Guidelines for Product Owners

### Marcus (Warehouse/Inventory)

Submit requests for:

- Item Master management
- Stock tracking and movements
- Bin locations and warehouse operations
- Inventory adjustments and cycle counts
- Lot and serial number tracking

### Sarah (Sales/CRM)

Submit requests for:

- Customer management
- Sales order processing
- Pricing and invoicing
- Quote generation
- Customer portal and self-service

### Alex (Procurement/Vendors)

Submit requests for:

- Vendor management
- Purchase order processing
- RFQs and quote comparisons
- Receiving and quality checks
- Supplier performance tracking

---

## Adding New Requests

1. Use format: `REQ-{DOMAIN}-{NUMBER}: {Title}`
2. Set status to PENDING
3. Assign to appropriate owner (marcus/sarah/alex)
4. Set priority (P0=Critical, P1=High, P2=Medium, P3=Low)
5. Describe business value clearly
6. List specific requirements
7. **If providing screenshots/assets**: Create directory `project-spirit/owner_requests/assets/REQ-{DOMAIN}-{NUMBER}/` and place images there
8. Strategic orchestrator will detect and route automatically

---

**Last Updated**: 2025-12-21
**Total Active Requests**: 8
**Total In Progress**: 1
**Total Completed**: 0
